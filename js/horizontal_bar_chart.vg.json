{
    "$schema"   : "https://vega.github.io/schema/vega-lite/v5.json",
    "width"     : 800,
    "height"    : 500,
    "background": null,
    "title": {"text": "",
              "fontSize": 24,
              "font": "sans-serif",
              "color": "indianred"},
    "data": {"url": "https://raw.githubusercontent.com/selinalaii/FIT3179/main/data/youtube.csv"},

    "params": [{"name": "youtuber_count",
                "value": 6,
                "bind": {"input": "range",
                         "min": 3,
                         "max": 10,
                         "step": 1,
                         "name": "Youtuber Count: "}}],

    "config": {"view": {"stroke": "transparent"}},

    "transform": [{"window": [{"field": "highest_yearly_earnings", "op": "rank", "as": "rank"}],
                  "sort":[{"field": "highest_yearly_earnings", "order": "descending"}]},
                  {"filter": "datum.rank <= youtuber_count"}],

    "layer": [{"mark": {"type": "bar", "size": 12},
               "encoding": {"y": {"field": "Youtuber", "type": "ordinal", "title": "YouTuber", "sort": "-x"},
                            "x": {"field": "highest_yearly_earnings", "aggregate": "max", "type": "quantitative", "scale": {"domain": [0, 120000000]}, "axis": {"grid": false}},
                            "size": {"value":30},
                            "color": {"condition": {"test": "datum.Youtuber === 'DaFuq!?Boom!'", "value": "#660000"},
                                      "value": "#FF6666"},
                            "tooltip": [{"field": "Youtuber", "type": "nominal", "title": "Youtuber"},
                                        {"field": "subscribers", "type": "nominal", "title": "Subscriber Count", "format": ","},
                                        {"field": "category", "type": "nominal", "title": "Category"},
                                        {"field": "highest_yearly_earnings", "type": "quantitative", "title": "Estimated Yearly Earnings", "format": ","}]}},
                                    
                {"mark": {"type": "text",
                "align": "center",
                "baseline": "left",
                "dy": -93,
                "dx": 300,
                "fontSize": 11,
                "fontStyle": "italic"},

                "encoding": {"text": {"condition": {"test": "datum['Youtuber'] == 'T-Series'",
                                                    "value": ["T-Series is the top subscribed", "YouTube channel and has the second highest", "estimated yearly earnings in 2023"]}},
                            "color": { "value": "black" },
                            "opacity": {"condition": {"test": "datum['Youtuber'] == 'T-Series'",
                                        "value": 1},
                            "value": 0}}}]}